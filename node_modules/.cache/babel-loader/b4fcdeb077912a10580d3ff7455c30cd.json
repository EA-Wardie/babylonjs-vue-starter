{"ast":null,"code":"import \"core-js/modules/es.object.define-property.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport { Scene } from \"../scene.js\";\nimport { SceneComponentConstants } from \"../sceneComponent.js\";\nimport { DepthPeelingRenderer } from \"./depthPeelingRenderer.js\";\nObject.defineProperty(Scene.prototype, \"depthPeelingRenderer\", {\n  get: function get() {\n    if (!this._depthPeelingRenderer) {\n      var component = this._getComponent(SceneComponentConstants.NAME_DEPTHPEELINGRENDERER);\n\n      if (!component) {\n        component = new DepthPeelingSceneComponent(this);\n\n        this._addComponent(component);\n      }\n    }\n\n    return this._depthPeelingRenderer;\n  },\n  set: function set(value) {\n    this._depthPeelingRenderer = value;\n  },\n  enumerable: true,\n  configurable: true\n});\nObject.defineProperty(Scene.prototype, \"useOrderIndependentTransparency\", {\n  get: function get() {\n    return this._useOrderIndependentTransparency;\n  },\n  set: function set(value) {\n    var _a;\n\n    if (this._useOrderIndependentTransparency === value) {\n      return;\n    }\n\n    this._useOrderIndependentTransparency = value;\n    this.markAllMaterialsAsDirty(63);\n    (_a = this.prePassRenderer) === null || _a === void 0 ? void 0 : _a.markAsDirty();\n  },\n  enumerable: true,\n  configurable: true\n});\n/**\n * Scene component to render order independent transparency with depth peeling\n */\n\nvar DepthPeelingSceneComponent =\n/** @class */\nfunction () {\n  /**\n   * Creates a new instance of the component for the given scene\n   * @param scene Defines the scene to register the component in\n   */\n  function DepthPeelingSceneComponent(scene) {\n    /**\n     * The component name helpful to identify the component in the list of scene components.\n     */\n    this.name = SceneComponentConstants.NAME_DEPTHPEELINGRENDERER;\n    this.scene = scene;\n    scene.depthPeelingRenderer = new DepthPeelingRenderer(scene);\n  }\n  /**\n   * Registers the component in a given scene\n   */\n\n\n  DepthPeelingSceneComponent.prototype.register = function () {};\n  /**\n   * Rebuilds the elements related to this component in case of\n   * context lost for instance.\n   */\n\n\n  DepthPeelingSceneComponent.prototype.rebuild = function () {};\n  /**\n   * Disposes the component and the associated resources.\n   */\n\n\n  DepthPeelingSceneComponent.prototype.dispose = function () {\n    var _a;\n\n    (_a = this.scene.depthPeelingRenderer) === null || _a === void 0 ? void 0 : _a.dispose();\n    this.scene.depthPeelingRenderer = null;\n  };\n\n  return DepthPeelingSceneComponent;\n}();\n\nexport { DepthPeelingSceneComponent };","map":{"version":3,"mappings":";;AACA,SAASA,KAAT,QAAsB,aAAtB;AAEA,SAASC,uBAAT,QAAwC,sBAAxC;AAEA,SAASC,oBAAT,QAAqC,2BAArC;AAoBAC,MAAM,CAACC,cAAP,CAAsBJ,KAAK,CAACK,SAA5B,EAAuC,sBAAvC,EAA+D;AAC3DC,KAAG,EAAE;AACD,QAAI,CAAC,KAAKC,qBAAV,EAAiC;AAC7B,UAAIC,SAAS,GAAG,KAAKC,aAAL,CAAmBR,uBAAuB,CAACS,yBAA3C,CAAhB;;AACA,UAAI,CAACF,SAAL,EAAgB;AACZA,iBAAS,GAAG,IAAIG,0BAAJ,CAA+B,IAA/B,CAAZ;;AACA,aAAKC,aAAL,CAAmBJ,SAAnB;AACH;AACJ;;AAED,WAAO,KAAKD,qBAAZ;AACH,GAX0D;AAY3DM,KAAG,EAAE,aAAuBC,KAAvB,EAAkD;AACnD,SAAKP,qBAAL,GAA6BO,KAA7B;AACH,GAd0D;AAe3DC,YAAU,EAAE,IAf+C;AAgB3DC,cAAY,EAAE;AAhB6C,CAA/D;AAmBAb,MAAM,CAACC,cAAP,CAAsBJ,KAAK,CAACK,SAA5B,EAAuC,iCAAvC,EAA0E;AACtEC,KAAG,EAAE;AACD,WAAO,KAAKW,gCAAZ;AACH,GAHqE;AAItEJ,KAAG,EAAE,aAAuBC,KAAvB,EAAqC;;;AACtC,QAAI,KAAKG,gCAAL,KAA0CH,KAA9C,EAAqD;AACjD;AACH;;AACD,SAAKG,gCAAL,GAAwCH,KAAxC;AACA,SAAKI,uBAAL,CAA6B,EAA7B;AACA,eAAKC,eAAL,MAAoB,IAApB,IAAoBC,aAApB,GAAoB,MAApB,GAAoBA,GAAEC,WAAF,EAApB;AACH,GAXqE;AAYtEN,YAAU,EAAE,IAZ0D;AAatEC,cAAY,EAAE;AAbwD,CAA1E;AAgBA;;;;AAGA;AAAA;AAAA;AAWI;;;;AAIA,sCAAYM,KAAZ,EAAwB;AAdxB;;;AAGgB,gBAAOrB,uBAAuB,CAACS,yBAA/B;AAYZ,SAAKY,KAAL,GAAaA,KAAb;AAEAA,SAAK,CAACC,oBAAN,GAA6B,IAAIrB,oBAAJ,CAAyBoB,KAAzB,CAA7B;AACH;AAED;;;;;AAGOX,kDAAP,aAA0B,CAAnB;AAEP;;;;;;AAIOA,iDAAP,aAAyB,CAAlB;AAEP;;;;;AAGOA,iDAAP;;;AACI,eAAKW,KAAL,CAAWC,oBAAX,MAA+B,IAA/B,IAA+BH,aAA/B,GAA+B,MAA/B,GAA+BA,GAAEI,OAAF,EAA/B;AACA,SAAKF,KAAL,CAAWC,oBAAX,GAAkC,IAAlC;AACH,GAHM;;AAIX;AAAC,CAvCD","names":["Scene","SceneComponentConstants","DepthPeelingRenderer","Object","defineProperty","prototype","get","_depthPeelingRenderer","component","_getComponent","NAME_DEPTHPEELINGRENDERER","DepthPeelingSceneComponent","_addComponent","set","value","enumerable","configurable","_useOrderIndependentTransparency","markAllMaterialsAsDirty","prePassRenderer","_a","markAsDirty","scene","depthPeelingRenderer","dispose"],"sourceRoot":"","sources":["../../../../../lts/core/generated/Rendering/depthPeelingSceneComponent.ts"],"sourcesContent":["import { Constants } from \"../Engines/constants\";\r\nimport { Scene } from \"../scene\";\r\nimport type { ISceneComponent } from \"../sceneComponent\";\r\nimport { SceneComponentConstants } from \"../sceneComponent\";\r\nimport type { Nullable } from \"../types\";\r\nimport { DepthPeelingRenderer } from \"./depthPeelingRenderer\";\r\n\r\ndeclare module \"../scene\" {\r\n    export interface Scene {\r\n        /**\r\n         * The depth peeling renderer\r\n         */\r\n        depthPeelingRenderer: Nullable<DepthPeelingRenderer>;\r\n        /** @hidden (Backing field) */\r\n        _depthPeelingRenderer: Nullable<DepthPeelingRenderer>;\r\n\r\n        /**\r\n         * Flag to indicate if we want to use order independent transparency, despite the performance hit\r\n         */\r\n        useOrderIndependentTransparency: boolean;\r\n        /** @hidden */\r\n        _useOrderIndependentTransparency: boolean;\r\n    }\r\n}\r\n\r\nObject.defineProperty(Scene.prototype, \"depthPeelingRenderer\", {\r\n    get: function (this: Scene) {\r\n        if (!this._depthPeelingRenderer) {\r\n            let component = this._getComponent(SceneComponentConstants.NAME_DEPTHPEELINGRENDERER) as DepthPeelingSceneComponent;\r\n            if (!component) {\r\n                component = new DepthPeelingSceneComponent(this);\r\n                this._addComponent(component);\r\n            }\r\n        }\r\n\r\n        return this._depthPeelingRenderer;\r\n    },\r\n    set: function (this: Scene, value: DepthPeelingRenderer) {\r\n        this._depthPeelingRenderer = value;\r\n    },\r\n    enumerable: true,\r\n    configurable: true,\r\n});\r\n\r\nObject.defineProperty(Scene.prototype, \"useOrderIndependentTransparency\", {\r\n    get: function (this: Scene) {\r\n        return this._useOrderIndependentTransparency;\r\n    },\r\n    set: function (this: Scene, value: boolean) {\r\n        if (this._useOrderIndependentTransparency === value) {\r\n            return;\r\n        }\r\n        this._useOrderIndependentTransparency = value;\r\n        this.markAllMaterialsAsDirty(Constants.MATERIAL_AllDirtyFlag);\r\n        this.prePassRenderer?.markAsDirty();\r\n    },\r\n    enumerable: true,\r\n    configurable: true,\r\n});\r\n\r\n/**\r\n * Scene component to render order independent transparency with depth peeling\r\n */\r\nexport class DepthPeelingSceneComponent implements ISceneComponent {\r\n    /**\r\n     * The component name helpful to identify the component in the list of scene components.\r\n     */\r\n    public readonly name = SceneComponentConstants.NAME_DEPTHPEELINGRENDERER;\r\n\r\n    /**\r\n     * The scene the component belongs to.\r\n     */\r\n    public scene: Scene;\r\n\r\n    /**\r\n     * Creates a new instance of the component for the given scene\r\n     * @param scene Defines the scene to register the component in\r\n     */\r\n    constructor(scene: Scene) {\r\n        this.scene = scene;\r\n\r\n        scene.depthPeelingRenderer = new DepthPeelingRenderer(scene);\r\n    }\r\n\r\n    /**\r\n     * Registers the component in a given scene\r\n     */\r\n    public register(): void {}\r\n\r\n    /**\r\n     * Rebuilds the elements related to this component in case of\r\n     * context lost for instance.\r\n     */\r\n    public rebuild(): void {}\r\n\r\n    /**\r\n     * Disposes the component and the associated resources.\r\n     */\r\n    public dispose(): void {\r\n        this.scene.depthPeelingRenderer?.dispose();\r\n        this.scene.depthPeelingRenderer = null;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}