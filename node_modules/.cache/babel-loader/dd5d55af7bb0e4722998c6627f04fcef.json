{"ast":null,"code":"import \"core-js/modules/es.object.define-property.js\";\nvar _maxGroups = 4;\n\nvar _maxBindingsPerGroup = 1 << 16; // all types not listed are assumed to consume 1 location\n\n\nvar _typeToLocationSize = {\n  // GLSL types\n  mat2: 2,\n  mat3: 3,\n  mat4: 4,\n  // WGSL types\n  mat2x2: 2,\n  mat3x3: 3,\n  mat4x4: 4\n};\n/**\n * @hidden\n */\n\nvar WebGPUShaderProcessingContext =\n/** @class */\nfunction () {\n  function WebGPUShaderProcessingContext(shaderLanguage) {\n    this.shaderLanguage = shaderLanguage;\n    this._attributeNextLocation = 0;\n    this._varyingNextLocation = 0;\n    this.freeGroupIndex = 0;\n    this.freeBindingIndex = 0;\n    this.availableVaryings = {};\n    this.availableAttributes = {};\n    this.availableBuffers = {};\n    this.availableTextures = {};\n    this.availableSamplers = {};\n    this.orderedAttributes = [];\n    this.bindGroupLayoutEntries = [];\n    this.bindGroupLayoutEntryInfo = [];\n    this.bindGroupEntries = [];\n    this.bufferNames = [];\n    this.textureNames = [];\n    this.samplerNames = [];\n    this.leftOverUniforms = [];\n\n    this._findStartingGroupBinding();\n  }\n\n  Object.defineProperty(WebGPUShaderProcessingContext, \"KnownUBOs\", {\n    get: function get() {\n      return WebGPUShaderProcessingContext._SimplifiedKnownBindings ? WebGPUShaderProcessingContext._SimplifiedKnownUBOs : WebGPUShaderProcessingContext._KnownUBOs;\n    },\n    enumerable: false,\n    configurable: true\n  });\n\n  WebGPUShaderProcessingContext.prototype._findStartingGroupBinding = function () {\n    var knownUBOs = WebGPUShaderProcessingContext.KnownUBOs;\n    var groups = [];\n\n    for (var name_1 in knownUBOs) {\n      var binding = knownUBOs[name_1].binding;\n\n      if (binding.groupIndex === -1) {\n        continue;\n      }\n\n      if (groups[binding.groupIndex] === undefined) {\n        groups[binding.groupIndex] = binding.bindingIndex;\n      } else {\n        groups[binding.groupIndex] = Math.max(groups[binding.groupIndex], binding.bindingIndex);\n      }\n    }\n\n    this.freeGroupIndex = groups.length - 1;\n\n    if (this.freeGroupIndex === 0) {\n      this.freeGroupIndex++;\n      this.freeBindingIndex = 0;\n    } else {\n      this.freeBindingIndex = groups[groups.length - 1] + 1;\n    }\n  };\n\n  WebGPUShaderProcessingContext.prototype.getAttributeNextLocation = function (dataType, arrayLength) {\n    var _a;\n\n    if (arrayLength === void 0) {\n      arrayLength = 0;\n    }\n\n    var index = this._attributeNextLocation;\n    this._attributeNextLocation += ((_a = _typeToLocationSize[dataType]) !== null && _a !== void 0 ? _a : 1) * (arrayLength || 1);\n    return index;\n  };\n\n  WebGPUShaderProcessingContext.prototype.getVaryingNextLocation = function (dataType, arrayLength) {\n    var _a;\n\n    if (arrayLength === void 0) {\n      arrayLength = 0;\n    }\n\n    var index = this._varyingNextLocation;\n    this._varyingNextLocation += ((_a = _typeToLocationSize[dataType]) !== null && _a !== void 0 ? _a : 1) * (arrayLength || 1);\n    return index;\n  };\n\n  WebGPUShaderProcessingContext.prototype.getNextFreeUBOBinding = function () {\n    return this._getNextFreeBinding(1);\n  };\n\n  WebGPUShaderProcessingContext.prototype._getNextFreeBinding = function (bindingCount) {\n    if (this.freeBindingIndex > _maxBindingsPerGroup - bindingCount) {\n      this.freeGroupIndex++;\n      this.freeBindingIndex = 0;\n    }\n\n    if (this.freeGroupIndex === _maxGroups) {\n      throw \"Too many textures or UBOs have been declared and it is not supported in WebGPU.\";\n    }\n\n    var returnValue = {\n      groupIndex: this.freeGroupIndex,\n      bindingIndex: this.freeBindingIndex\n    };\n    this.freeBindingIndex += bindingCount;\n    return returnValue;\n  };\n  /** @hidden */\n\n\n  WebGPUShaderProcessingContext._SimplifiedKnownBindings = true; // if true, use only group=0,binding=0 as a known group/binding for the Scene ubo and use group=1,binding=X for all other bindings\n  // if false, see _KnownUBOs for the known groups/bindings used\n\n  WebGPUShaderProcessingContext._SimplifiedKnownUBOs = {\n    Scene: {\n      binding: {\n        groupIndex: 0,\n        bindingIndex: 0\n      }\n    },\n    Light0: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light1: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light2: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light3: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light4: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light5: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light6: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light7: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light8: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light9: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light10: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light11: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light12: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light13: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light14: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light15: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light16: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light17: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light18: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light19: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light20: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light21: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light22: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light23: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light24: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light25: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light26: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light27: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light28: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light29: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light30: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Light31: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Material: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Mesh: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    },\n    Internals: {\n      binding: {\n        groupIndex: -1,\n        bindingIndex: -1\n      }\n    }\n  };\n  WebGPUShaderProcessingContext._KnownUBOs = {\n    Scene: {\n      binding: {\n        groupIndex: 0,\n        bindingIndex: 0\n      }\n    },\n    Light0: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 0\n      }\n    },\n    Light1: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 1\n      }\n    },\n    Light2: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 2\n      }\n    },\n    Light3: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 3\n      }\n    },\n    Light4: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 4\n      }\n    },\n    Light5: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 5\n      }\n    },\n    Light6: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 6\n      }\n    },\n    Light7: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 7\n      }\n    },\n    Light8: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 8\n      }\n    },\n    Light9: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 9\n      }\n    },\n    Light10: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 10\n      }\n    },\n    Light11: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 11\n      }\n    },\n    Light12: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 12\n      }\n    },\n    Light13: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 13\n      }\n    },\n    Light14: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 14\n      }\n    },\n    Light15: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 15\n      }\n    },\n    Light16: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 16\n      }\n    },\n    Light17: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 17\n      }\n    },\n    Light18: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 18\n      }\n    },\n    Light19: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 19\n      }\n    },\n    Light20: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 20\n      }\n    },\n    Light21: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 21\n      }\n    },\n    Light22: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 22\n      }\n    },\n    Light23: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 23\n      }\n    },\n    Light24: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 24\n      }\n    },\n    Light25: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 25\n      }\n    },\n    Light26: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 26\n      }\n    },\n    Light27: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 27\n      }\n    },\n    Light28: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 28\n      }\n    },\n    Light29: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 29\n      }\n    },\n    Light30: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 30\n      }\n    },\n    Light31: {\n      binding: {\n        groupIndex: 1,\n        bindingIndex: 31\n      }\n    },\n    Material: {\n      binding: {\n        groupIndex: 2,\n        bindingIndex: 0\n      }\n    },\n    Mesh: {\n      binding: {\n        groupIndex: 2,\n        bindingIndex: 1\n      }\n    },\n    Internals: {\n      binding: {\n        groupIndex: 2,\n        bindingIndex: 2\n      }\n    }\n  };\n  return WebGPUShaderProcessingContext;\n}();\n\nexport { WebGPUShaderProcessingContext };","map":{"version":3,"mappings":"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","names":["_maxGroups","_maxBindingsPerGroup","_typeToLocationSize","mat2","mat3","mat4","mat2x2","mat3x3","mat4x4","shaderLanguage","_attributeNextLocation","_varyingNextLocation","freeGroupIndex","freeBindingIndex","availableVaryings","availableAttributes","availableBuffers","availableTextures","availableSamplers","orderedAttributes","bindGroupLayoutEntries","bindGroupLayoutEntryInfo","bindGroupEntries","bufferNames","textureNames","samplerNames","leftOverUniforms","_findStartingGroupBinding","Object","WebGPUShaderProcessingContext","_SimplifiedKnownBindings","_SimplifiedKnownUBOs","_KnownUBOs","knownUBOs","KnownUBOs","groups","name_1","binding","groupIndex","undefined","bindingIndex","Math","max","length","dataType","arrayLength","index","_a","_getNextFreeBinding","bindingCount","returnValue","Scene","Light0","Light1","Light2","Light3","Light4","Light5","Light6","Light7","Light8","Light9","Light10","Light11","Light12","Light13","Light14","Light15","Light16","Light17","Light18","Light19","Light20","Light21","Light22","Light23","Light24","Light25","Light26","Light27","Light28","Light29","Light30","Light31","Material","Mesh","Internals"],"sourceRoot":"","sources":["../../../../../../lts/core/generated/Engines/WebGPU/webgpuShaderProcessingContext.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/naming-convention */\r\nimport type { ShaderLanguage } from \"../../Materials/shaderLanguage\";\r\nimport type { ShaderProcessingContext } from \"../Processors/shaderProcessingOptions\";\r\n\r\nconst _maxGroups = 4;\r\nconst _maxBindingsPerGroup = 1 << 16;\r\n\r\n// all types not listed are assumed to consume 1 location\r\nconst _typeToLocationSize: { [key: string]: number } = {\r\n    // GLSL types\r\n    mat2: 2,\r\n    mat3: 3,\r\n    mat4: 4,\r\n\r\n    // WGSL types\r\n    mat2x2: 2,\r\n    mat3x3: 3,\r\n    mat4x4: 4,\r\n};\r\n\r\n/** @hidden */\r\nexport interface WebGPUBindingInfo {\r\n    groupIndex: number;\r\n    bindingIndex: number;\r\n}\r\n\r\n/** @hidden */\r\nexport interface WebGPUTextureDescription {\r\n    autoBindSampler?: boolean;\r\n    isTextureArray: boolean;\r\n    isStorageTexture: boolean;\r\n    textures: Array<WebGPUBindingInfo>;\r\n    sampleType?: GPUTextureSampleType; // not used if the texture is a storage texture\r\n}\r\n\r\n/** @hidden */\r\nexport interface WebGPUSamplerDescription {\r\n    binding: WebGPUBindingInfo;\r\n    type: GPUSamplerBindingType;\r\n}\r\n\r\n/** @hidden */\r\nexport interface WebGPUBufferDescription {\r\n    binding: WebGPUBindingInfo;\r\n}\r\n\r\n/** @hidden */\r\nexport interface WebGPUBindGroupLayoutEntryInfo {\r\n    name: string;\r\n    index: number; // index of the entry (GPUBindGroupLayoutEntry) in the bindGroupLayoutEntries[group] array\r\n    nameInArrayOfTexture?: string; // something like texture0, texture1, ... if texture is an array, else same thing as \"name\"\r\n}\r\n\r\n/**\r\n * @hidden\r\n */\r\nexport class WebGPUShaderProcessingContext implements ShaderProcessingContext {\r\n    /** @hidden */\r\n    public static _SimplifiedKnownBindings = true; // if true, use only group=0,binding=0 as a known group/binding for the Scene ubo and use group=1,binding=X for all other bindings\r\n    // if false, see _KnownUBOs for the known groups/bindings used\r\n\r\n    protected static _SimplifiedKnownUBOs: { [key: string]: WebGPUBufferDescription } = {\r\n        Scene: { binding: { groupIndex: 0, bindingIndex: 0 } },\r\n        Light0: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light1: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light2: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light3: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light4: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light5: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light6: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light7: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light8: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light9: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light10: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light11: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light12: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light13: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light14: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light15: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light16: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light17: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light18: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light19: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light20: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light21: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light22: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light23: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light24: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light25: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light26: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light27: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light28: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light29: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light30: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Light31: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Material: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Mesh: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n        Internals: { binding: { groupIndex: -1, bindingIndex: -1 } },\r\n    };\r\n\r\n    protected static _KnownUBOs: { [key: string]: WebGPUBufferDescription } = {\r\n        Scene: { binding: { groupIndex: 0, bindingIndex: 0 } },\r\n\r\n        Light0: { binding: { groupIndex: 1, bindingIndex: 0 } },\r\n        Light1: { binding: { groupIndex: 1, bindingIndex: 1 } },\r\n        Light2: { binding: { groupIndex: 1, bindingIndex: 2 } },\r\n        Light3: { binding: { groupIndex: 1, bindingIndex: 3 } },\r\n        Light4: { binding: { groupIndex: 1, bindingIndex: 4 } },\r\n        Light5: { binding: { groupIndex: 1, bindingIndex: 5 } },\r\n        Light6: { binding: { groupIndex: 1, bindingIndex: 6 } },\r\n        Light7: { binding: { groupIndex: 1, bindingIndex: 7 } },\r\n        Light8: { binding: { groupIndex: 1, bindingIndex: 8 } },\r\n        Light9: { binding: { groupIndex: 1, bindingIndex: 9 } },\r\n        Light10: { binding: { groupIndex: 1, bindingIndex: 10 } },\r\n        Light11: { binding: { groupIndex: 1, bindingIndex: 11 } },\r\n        Light12: { binding: { groupIndex: 1, bindingIndex: 12 } },\r\n        Light13: { binding: { groupIndex: 1, bindingIndex: 13 } },\r\n        Light14: { binding: { groupIndex: 1, bindingIndex: 14 } },\r\n        Light15: { binding: { groupIndex: 1, bindingIndex: 15 } },\r\n        Light16: { binding: { groupIndex: 1, bindingIndex: 16 } },\r\n        Light17: { binding: { groupIndex: 1, bindingIndex: 17 } },\r\n        Light18: { binding: { groupIndex: 1, bindingIndex: 18 } },\r\n        Light19: { binding: { groupIndex: 1, bindingIndex: 19 } },\r\n        Light20: { binding: { groupIndex: 1, bindingIndex: 20 } },\r\n        Light21: { binding: { groupIndex: 1, bindingIndex: 21 } },\r\n        Light22: { binding: { groupIndex: 1, bindingIndex: 22 } },\r\n        Light23: { binding: { groupIndex: 1, bindingIndex: 23 } },\r\n        Light24: { binding: { groupIndex: 1, bindingIndex: 24 } },\r\n        Light25: { binding: { groupIndex: 1, bindingIndex: 25 } },\r\n        Light26: { binding: { groupIndex: 1, bindingIndex: 26 } },\r\n        Light27: { binding: { groupIndex: 1, bindingIndex: 27 } },\r\n        Light28: { binding: { groupIndex: 1, bindingIndex: 28 } },\r\n        Light29: { binding: { groupIndex: 1, bindingIndex: 29 } },\r\n        Light30: { binding: { groupIndex: 1, bindingIndex: 30 } },\r\n        Light31: { binding: { groupIndex: 1, bindingIndex: 31 } },\r\n\r\n        Material: { binding: { groupIndex: 2, bindingIndex: 0 } },\r\n        Mesh: { binding: { groupIndex: 2, bindingIndex: 1 } },\r\n        Internals: { binding: { groupIndex: 2, bindingIndex: 2 } },\r\n    };\r\n\r\n    public static get KnownUBOs() {\r\n        return WebGPUShaderProcessingContext._SimplifiedKnownBindings ? WebGPUShaderProcessingContext._SimplifiedKnownUBOs : WebGPUShaderProcessingContext._KnownUBOs;\r\n    }\r\n\r\n    public shaderLanguage: ShaderLanguage;\r\n\r\n    public uboNextBindingIndex: number;\r\n    public freeGroupIndex: number;\r\n    public freeBindingIndex: number;\r\n\r\n    public availableVaryings: { [key: string]: number };\r\n    public availableAttributes: { [key: string]: number };\r\n    public availableBuffers: { [key: string]: WebGPUBufferDescription };\r\n    public availableTextures: { [key: string]: WebGPUTextureDescription };\r\n    public availableSamplers: { [key: string]: WebGPUSamplerDescription };\r\n\r\n    public leftOverUniforms: { name: string; type: string; length: number }[];\r\n\r\n    public orderedAttributes: string[];\r\n    public bindGroupLayoutEntries: GPUBindGroupLayoutEntry[][];\r\n    public bindGroupLayoutEntryInfo: WebGPUBindGroupLayoutEntryInfo[][];\r\n    public bindGroupEntries: GPUBindGroupEntry[][];\r\n    public bufferNames: string[]; // list of all uniform/storage buffer names used in the shader\r\n    public textureNames: string[]; // list of all texture names used in the shader\r\n    public samplerNames: string[]; // list of all sampler names used in the shader\r\n    public attributeNamesFromEffect: string[];\r\n    public attributeLocationsFromEffect: number[];\r\n\r\n    private _attributeNextLocation: number;\r\n    private _varyingNextLocation: number;\r\n\r\n    constructor(shaderLanguage: ShaderLanguage) {\r\n        this.shaderLanguage = shaderLanguage;\r\n\r\n        this._attributeNextLocation = 0;\r\n        this._varyingNextLocation = 0;\r\n        this.freeGroupIndex = 0;\r\n        this.freeBindingIndex = 0;\r\n\r\n        this.availableVaryings = {};\r\n        this.availableAttributes = {};\r\n        this.availableBuffers = {};\r\n        this.availableTextures = {};\r\n        this.availableSamplers = {};\r\n\r\n        this.orderedAttributes = [];\r\n        this.bindGroupLayoutEntries = [];\r\n        this.bindGroupLayoutEntryInfo = [];\r\n        this.bindGroupEntries = [];\r\n        this.bufferNames = [];\r\n        this.textureNames = [];\r\n        this.samplerNames = [];\r\n\r\n        this.leftOverUniforms = [];\r\n\r\n        this._findStartingGroupBinding();\r\n    }\r\n\r\n    private _findStartingGroupBinding(): void {\r\n        const knownUBOs = WebGPUShaderProcessingContext.KnownUBOs;\r\n\r\n        const groups: number[] = [];\r\n        for (const name in knownUBOs) {\r\n            const binding = knownUBOs[name].binding;\r\n            if (binding.groupIndex === -1) {\r\n                continue;\r\n            }\r\n            if (groups[binding.groupIndex] === undefined) {\r\n                groups[binding.groupIndex] = binding.bindingIndex;\r\n            } else {\r\n                groups[binding.groupIndex] = Math.max(groups[binding.groupIndex], binding.bindingIndex);\r\n            }\r\n        }\r\n\r\n        this.freeGroupIndex = groups.length - 1;\r\n        if (this.freeGroupIndex === 0) {\r\n            this.freeGroupIndex++;\r\n            this.freeBindingIndex = 0;\r\n        } else {\r\n            this.freeBindingIndex = groups[groups.length - 1] + 1;\r\n        }\r\n    }\r\n\r\n    public getAttributeNextLocation(dataType: string, arrayLength: number = 0): number {\r\n        const index = this._attributeNextLocation;\r\n\r\n        this._attributeNextLocation += (_typeToLocationSize[dataType] ?? 1) * (arrayLength || 1);\r\n\r\n        return index;\r\n    }\r\n\r\n    public getVaryingNextLocation(dataType: string, arrayLength: number = 0): number {\r\n        const index = this._varyingNextLocation;\r\n\r\n        this._varyingNextLocation += (_typeToLocationSize[dataType] ?? 1) * (arrayLength || 1);\r\n\r\n        return index;\r\n    }\r\n\r\n    public getNextFreeUBOBinding() {\r\n        return this._getNextFreeBinding(1);\r\n    }\r\n\r\n    private _getNextFreeBinding(bindingCount: number) {\r\n        if (this.freeBindingIndex > _maxBindingsPerGroup - bindingCount) {\r\n            this.freeGroupIndex++;\r\n            this.freeBindingIndex = 0;\r\n        }\r\n\r\n        if (this.freeGroupIndex === _maxGroups) {\r\n            throw \"Too many textures or UBOs have been declared and it is not supported in WebGPU.\";\r\n        }\r\n\r\n        const returnValue = {\r\n            groupIndex: this.freeGroupIndex,\r\n            bindingIndex: this.freeBindingIndex,\r\n        };\r\n\r\n        this.freeBindingIndex += bindingCount;\r\n\r\n        return returnValue;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}