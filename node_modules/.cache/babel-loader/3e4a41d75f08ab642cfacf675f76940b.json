{"ast":null,"code":"import \"core-js/modules/es.array-buffer.constructor.js\";\nimport \"core-js/modules/es.array-buffer.slice.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.typed-array.uint32-array.js\";\nimport \"core-js/modules/es.typed-array.at.js\";\nimport \"core-js/modules/es.typed-array.copy-within.js\";\nimport \"core-js/modules/es.typed-array.every.js\";\nimport \"core-js/modules/es.typed-array.fill.js\";\nimport \"core-js/modules/es.typed-array.filter.js\";\nimport \"core-js/modules/es.typed-array.find.js\";\nimport \"core-js/modules/es.typed-array.find-index.js\";\nimport \"core-js/modules/es.typed-array.for-each.js\";\nimport \"core-js/modules/es.typed-array.includes.js\";\nimport \"core-js/modules/es.typed-array.index-of.js\";\nimport \"core-js/modules/es.typed-array.iterator.js\";\nimport \"core-js/modules/es.typed-array.join.js\";\nimport \"core-js/modules/es.typed-array.last-index-of.js\";\nimport \"core-js/modules/es.typed-array.map.js\";\nimport \"core-js/modules/es.typed-array.reduce.js\";\nimport \"core-js/modules/es.typed-array.reduce-right.js\";\nimport \"core-js/modules/es.typed-array.reverse.js\";\nimport \"core-js/modules/es.typed-array.set.js\";\nimport \"core-js/modules/es.typed-array.slice.js\";\nimport \"core-js/modules/es.typed-array.some.js\";\nimport \"core-js/modules/es.typed-array.sort.js\";\nimport \"core-js/modules/es.typed-array.subarray.js\";\nimport \"core-js/modules/es.typed-array.to-locale-string.js\";\nimport \"core-js/modules/es.typed-array.to-string.js\";\nimport \"core-js/modules/es.typed-array.int32-array.js\";\nimport \"core-js/modules/es.typed-array.float32-array.js\";\n\n/** @hidden */\nvar NativeDataStream =\n/** @class */\nfunction () {\n  function NativeDataStream() {\n    var _this = this;\n\n    var buffer = new ArrayBuffer(NativeDataStream.DEFAULT_BUFFER_SIZE);\n    this._uint32s = new Uint32Array(buffer);\n    this._int32s = new Int32Array(buffer);\n    this._float32s = new Float32Array(buffer);\n    this._length = NativeDataStream.DEFAULT_BUFFER_SIZE / 4;\n    this._position = 0;\n    this._nativeDataStream = new _native.NativeDataStream(function () {\n      _this._flush();\n    });\n  }\n\n  NativeDataStream.prototype.writeUint32 = function (value) {\n    this._flushIfNecessary(1);\n\n    this._uint32s[this._position++] = value;\n  };\n\n  NativeDataStream.prototype.writeInt32 = function (value) {\n    this._flushIfNecessary(1);\n\n    this._int32s[this._position++] = value;\n  };\n\n  NativeDataStream.prototype.writeFloat32 = function (value) {\n    this._flushIfNecessary(1);\n\n    this._float32s[this._position++] = value;\n  };\n\n  NativeDataStream.prototype.writeUint32Array = function (values) {\n    this._flushIfNecessary(1 + values.length);\n\n    this._uint32s[this._position++] = values.length;\n\n    this._uint32s.set(values, this._position);\n\n    this._position += values.length;\n  };\n\n  NativeDataStream.prototype.writeInt32Array = function (values) {\n    this._flushIfNecessary(1 + values.length);\n\n    this._uint32s[this._position++] = values.length;\n\n    this._int32s.set(values, this._position);\n\n    this._position += values.length;\n  };\n\n  NativeDataStream.prototype.writeFloat32Array = function (values) {\n    this._flushIfNecessary(1 + values.length);\n\n    this._uint32s[this._position++] = values.length;\n\n    this._float32s.set(values, this._position);\n\n    this._position += values.length;\n  };\n\n  NativeDataStream.prototype.writeNativeData = function (handle) {\n    this._flushIfNecessary(handle.length);\n\n    this._uint32s.set(handle, this._position);\n\n    this._position += handle.length;\n  };\n\n  NativeDataStream.prototype.writeBoolean = function (value) {\n    this.writeUint32(value ? 1 : 0);\n  };\n\n  NativeDataStream.prototype._flushIfNecessary = function (required) {\n    if (this._position + required > this._length) {\n      this._flush();\n    }\n  };\n\n  NativeDataStream.prototype._flush = function () {\n    this._nativeDataStream.writeBuffer(this._uint32s.buffer, this._position);\n\n    this._position = 0;\n  }; // Must be multiple of 4!\n  // eslint-disable-next-line @typescript-eslint/naming-convention\n\n\n  NativeDataStream.DEFAULT_BUFFER_SIZE = 65536;\n  return NativeDataStream;\n}();\n\nexport { NativeDataStream };","map":{"version":3,"mappings":"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","names":["buffer","ArrayBuffer","NativeDataStream","DEFAULT_BUFFER_SIZE","_uint32s","Uint32Array","_int32s","Int32Array","_float32s","Float32Array","_length","_position","_nativeDataStream","_native","_this","_flush","value","_flushIfNecessary","values","length","set","handle","writeUint32","required","writeBuffer"],"sourceRoot":"","sources":["../../../../../../lts/core/generated/Engines/Native/nativeDataStream.ts"],"sourcesContent":["import type { INative, INativeDataStream } from \"./nativeInterfaces\";\r\n\r\ndeclare const _native: INative;\r\n\r\n/** @hidden */\r\nexport type NativeData = Uint32Array;\r\n\r\n/** @hidden */\r\nexport class NativeDataStream {\r\n    private readonly _uint32s: Uint32Array;\r\n    private readonly _int32s: Int32Array;\r\n    private readonly _float32s: Float32Array;\r\n    private readonly _length: number;\r\n    private _position: number;\r\n    private readonly _nativeDataStream: INativeDataStream;\r\n\r\n    // Must be multiple of 4!\r\n    // eslint-disable-next-line @typescript-eslint/naming-convention\r\n    private static readonly DEFAULT_BUFFER_SIZE = 65536;\r\n\r\n    constructor() {\r\n        const buffer = new ArrayBuffer(NativeDataStream.DEFAULT_BUFFER_SIZE);\r\n        this._uint32s = new Uint32Array(buffer);\r\n        this._int32s = new Int32Array(buffer);\r\n        this._float32s = new Float32Array(buffer);\r\n\r\n        this._length = NativeDataStream.DEFAULT_BUFFER_SIZE / 4;\r\n        this._position = 0;\r\n\r\n        this._nativeDataStream = new _native.NativeDataStream(() => {\r\n            this._flush();\r\n        });\r\n    }\r\n\r\n    public writeUint32(value: number): void {\r\n        this._flushIfNecessary(1);\r\n        this._uint32s[this._position++] = value;\r\n    }\r\n\r\n    public writeInt32(value: number): void {\r\n        this._flushIfNecessary(1);\r\n        this._int32s[this._position++] = value;\r\n    }\r\n\r\n    public writeFloat32(value: number): void {\r\n        this._flushIfNecessary(1);\r\n        this._float32s[this._position++] = value;\r\n    }\r\n\r\n    public writeUint32Array(values: Uint32Array): void {\r\n        this._flushIfNecessary(1 + values.length);\r\n        this._uint32s[this._position++] = values.length;\r\n        this._uint32s.set(values, this._position);\r\n        this._position += values.length;\r\n    }\r\n\r\n    public writeInt32Array(values: Int32Array): void {\r\n        this._flushIfNecessary(1 + values.length);\r\n        this._uint32s[this._position++] = values.length;\r\n        this._int32s.set(values, this._position);\r\n        this._position += values.length;\r\n    }\r\n\r\n    public writeFloat32Array(values: Float32Array): void {\r\n        this._flushIfNecessary(1 + values.length);\r\n        this._uint32s[this._position++] = values.length;\r\n        this._float32s.set(values, this._position);\r\n        this._position += values.length;\r\n    }\r\n\r\n    public writeNativeData(handle: NativeData) {\r\n        this._flushIfNecessary(handle.length);\r\n        this._uint32s.set(handle, this._position);\r\n        this._position += handle.length;\r\n    }\r\n\r\n    public writeBoolean(value: boolean) {\r\n        this.writeUint32(value ? 1 : 0);\r\n    }\r\n\r\n    private _flushIfNecessary(required: number): void {\r\n        if (this._position + required > this._length) {\r\n            this._flush();\r\n        }\r\n    }\r\n\r\n    private _flush(): void {\r\n        this._nativeDataStream.writeBuffer(this._uint32s.buffer, this._position);\r\n        this._position = 0;\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}