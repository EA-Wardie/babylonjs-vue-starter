{"ast":null,"code":"import { WebGPUEngine } from \"../../webgpuEngine.js\";\nimport { WebGPURenderItemBeginOcclusionQuery, WebGPURenderItemEndOcclusionQuery } from \"../webgpuBundleList.js\";\n\nWebGPUEngine.prototype.getGPUFrameTimeCounter = function () {\n  return this._timestampQuery.gpuFrameTimeCounter;\n};\n\nWebGPUEngine.prototype.captureGPUFrameTime = function (value) {\n  this._timestampQuery.enable = value && !!this._caps.timerQuery;\n};\n\nWebGPUEngine.prototype.createQuery = function () {\n  return this._occlusionQuery.createQuery();\n};\n\nWebGPUEngine.prototype.deleteQuery = function (query) {\n  this._occlusionQuery.deleteQuery(query);\n\n  return this;\n};\n\nWebGPUEngine.prototype.isQueryResultAvailable = function (query) {\n  return this._occlusionQuery.isQueryResultAvailable(query);\n};\n\nWebGPUEngine.prototype.getQueryResult = function (query) {\n  return this._occlusionQuery.getQueryResult(query);\n};\n\nWebGPUEngine.prototype.beginOcclusionQuery = function (algorithmType, query) {\n  var _a;\n\n  if (this.compatibilityMode) {\n    if (this._occlusionQuery.canBeginQuery) {\n      (_a = this._currentRenderPass) === null || _a === void 0 ? void 0 : _a.beginOcclusionQuery(query);\n      return true;\n    }\n  } else {\n    var renderPassIndex = this._getCurrentRenderPassIndex();\n\n    var bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\n    bundleList.addItem(new WebGPURenderItemBeginOcclusionQuery(query));\n    return true;\n  }\n\n  return false;\n};\n\nWebGPUEngine.prototype.endOcclusionQuery = function () {\n  var _a;\n\n  if (this.compatibilityMode) {\n    (_a = this._currentRenderPass) === null || _a === void 0 ? void 0 : _a.endOcclusionQuery();\n  } else {\n    var renderPassIndex = this._getCurrentRenderPassIndex();\n\n    var bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\n    bundleList.addItem(new WebGPURenderItemEndOcclusionQuery());\n  }\n\n  return this;\n};","map":{"version":3,"mappings":"AACA,SAASA,YAAT,QAA6B,uBAA7B;AACA,SAASC,mCAAT,EAA8CC,iCAA9C,QAAuF,wBAAvF;;AAIAF,YAAY,CAACG,SAAb,CAAuBC,sBAAvB,GAAgD;AAC5C,SAAO,KAAKC,eAAL,CAAqBC,mBAA5B;AACH,CAFD;;AAIAN,YAAY,CAACG,SAAb,CAAuBI,mBAAvB,GAA6C,UAAUC,KAAV,EAAwB;AACjE,OAAKH,eAAL,CAAqBI,MAArB,GAA8BD,KAAK,IAAI,CAAC,CAAC,KAAKE,KAAL,CAAWC,UAApD;AACH,CAFD;;AAIAX,YAAY,CAACG,SAAb,CAAuBS,WAAvB,GAAqC;AACjC,SAAO,KAAKC,eAAL,CAAqBD,WAArB,EAAP;AACH,CAFD;;AAIAZ,YAAY,CAACG,SAAb,CAAuBW,WAAvB,GAAqC,UAAUC,KAAV,EAA+B;AAChE,OAAKF,eAAL,CAAqBC,WAArB,CAAiCC,KAAjC;;AAEA,SAAO,IAAP;AACH,CAJD;;AAMAf,YAAY,CAACG,SAAb,CAAuBa,sBAAvB,GAAgD,UAAUD,KAAV,EAA+B;AAC3E,SAAO,KAAKF,eAAL,CAAqBG,sBAArB,CAA4CD,KAA5C,CAAP;AACH,CAFD;;AAIAf,YAAY,CAACG,SAAb,CAAuBc,cAAvB,GAAwC,UAAUF,KAAV,EAA+B;AACnE,SAAO,KAAKF,eAAL,CAAqBI,cAArB,CAAoCF,KAApC,CAAP;AACH,CAFD;;AAIAf,YAAY,CAACG,SAAb,CAAuBe,mBAAvB,GAA6C,UAAUC,aAAV,EAAiCJ,KAAjC,EAAsD;;;AAC/F,MAAI,KAAKK,iBAAT,EAA4B;AACxB,QAAI,KAAKP,eAAL,CAAqBQ,aAAzB,EAAwC;AACpC,iBAAKC,kBAAL,MAAuB,IAAvB,IAAuBC,aAAvB,GAAuB,MAAvB,GAAuBA,GAAEL,mBAAF,CAAsBH,KAAtB,CAAvB;AACA,aAAO,IAAP;AACH;AACJ,GALD,MAKO;AACH,QAAMS,eAAe,GAAG,KAAKC,0BAAL,EAAxB;;AACA,QAAMC,UAAU,GAAGF,eAAe,KAAK,CAApB,GAAwB,KAAKG,WAA7B,GAA2C,KAAKC,uBAAnE;AACAF,cAAU,CAACG,OAAX,CAAmB,IAAI5B,mCAAJ,CAAwCc,KAAxC,CAAnB;AACA,WAAO,IAAP;AACH;;AAED,SAAO,KAAP;AACH,CAdD;;AAgBAf,YAAY,CAACG,SAAb,CAAuB2B,iBAAvB,GAA2C;;;AACvC,MAAI,KAAKV,iBAAT,EAA4B;AACxB,eAAKE,kBAAL,MAAuB,IAAvB,IAAuBC,aAAvB,GAAuB,MAAvB,GAAuBA,GAAEO,iBAAF,EAAvB;AACH,GAFD,MAEO;AACH,QAAMN,eAAe,GAAG,KAAKC,0BAAL,EAAxB;;AACA,QAAMC,UAAU,GAAGF,eAAe,KAAK,CAApB,GAAwB,KAAKG,WAA7B,GAA2C,KAAKC,uBAAnE;AACAF,cAAU,CAACG,OAAX,CAAmB,IAAI3B,iCAAJ,EAAnB;AACH;;AACD,SAAO,IAAP;AACH,CATD","names":["WebGPUEngine","WebGPURenderItemBeginOcclusionQuery","WebGPURenderItemEndOcclusionQuery","prototype","getGPUFrameTimeCounter","_timestampQuery","gpuFrameTimeCounter","captureGPUFrameTime","value","enable","_caps","timerQuery","createQuery","_occlusionQuery","deleteQuery","query","isQueryResultAvailable","getQueryResult","beginOcclusionQuery","algorithmType","compatibilityMode","canBeginQuery","_currentRenderPass","_a","renderPassIndex","_getCurrentRenderPassIndex","bundleList","_bundleList","_bundleListRenderTarget","addItem","endOcclusionQuery"],"sourceRoot":"","sources":["../../../../../../../lts/core/generated/Engines/WebGPU/Extensions/engine.query.ts"],"sourcesContent":["import type { OcclusionQuery } from \"../../Extensions/engine.query\";\r\nimport { WebGPUEngine } from \"../../webgpuEngine\";\r\nimport { WebGPURenderItemBeginOcclusionQuery, WebGPURenderItemEndOcclusionQuery } from \"../webgpuBundleList\";\r\n\r\ndeclare type PerfCounter = import(\"../../../Misc/perfCounter\").PerfCounter;\r\n\r\nWebGPUEngine.prototype.getGPUFrameTimeCounter = function (): PerfCounter {\r\n    return this._timestampQuery.gpuFrameTimeCounter;\r\n};\r\n\r\nWebGPUEngine.prototype.captureGPUFrameTime = function (value: boolean) {\r\n    this._timestampQuery.enable = value && !!this._caps.timerQuery;\r\n};\r\n\r\nWebGPUEngine.prototype.createQuery = function (): OcclusionQuery {\r\n    return this._occlusionQuery.createQuery();\r\n};\r\n\r\nWebGPUEngine.prototype.deleteQuery = function (query: OcclusionQuery): WebGPUEngine {\r\n    this._occlusionQuery.deleteQuery(query as number);\r\n\r\n    return this;\r\n};\r\n\r\nWebGPUEngine.prototype.isQueryResultAvailable = function (query: OcclusionQuery): boolean {\r\n    return this._occlusionQuery.isQueryResultAvailable(query as number);\r\n};\r\n\r\nWebGPUEngine.prototype.getQueryResult = function (query: OcclusionQuery): number {\r\n    return this._occlusionQuery.getQueryResult(query as number);\r\n};\r\n\r\nWebGPUEngine.prototype.beginOcclusionQuery = function (algorithmType: number, query: OcclusionQuery): boolean {\r\n    if (this.compatibilityMode) {\r\n        if (this._occlusionQuery.canBeginQuery) {\r\n            this._currentRenderPass?.beginOcclusionQuery(query as number);\r\n            return true;\r\n        }\r\n    } else {\r\n        const renderPassIndex = this._getCurrentRenderPassIndex();\r\n        const bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\r\n        bundleList.addItem(new WebGPURenderItemBeginOcclusionQuery(query as number));\r\n        return true;\r\n    }\r\n\r\n    return false;\r\n};\r\n\r\nWebGPUEngine.prototype.endOcclusionQuery = function (): WebGPUEngine {\r\n    if (this.compatibilityMode) {\r\n        this._currentRenderPass?.endOcclusionQuery();\r\n    } else {\r\n        const renderPassIndex = this._getCurrentRenderPassIndex();\r\n        const bundleList = renderPassIndex === 0 ? this._bundleList : this._bundleListRenderTarget;\r\n        bundleList.addItem(new WebGPURenderItemEndOcclusionQuery());\r\n    }\r\n    return this;\r\n};\r\n"]},"metadata":{},"sourceType":"module"}