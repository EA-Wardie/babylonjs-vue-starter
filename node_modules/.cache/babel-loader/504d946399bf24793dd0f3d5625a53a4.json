{"ast":null,"code":"import \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.sort.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.array.index-of.js\";\nimport { __extends } from \"tslib\";\n/**\n * Defines an GC Friendly array where the backfield array do not shrink to prevent over allocations.\n */\n\nvar SmartArray =\n/** @class */\nfunction () {\n  /**\n   * Instantiates a Smart Array.\n   * @param capacity defines the default capacity of the array.\n   */\n  function SmartArray(capacity) {\n    /**\n     * The active length of the array.\n     */\n    this.length = 0;\n    this.data = new Array(capacity);\n    this._id = SmartArray._GlobalId++;\n  }\n  /**\n   * Pushes a value at the end of the active data.\n   * @param value defines the object to push in the array.\n   */\n\n\n  SmartArray.prototype.push = function (value) {\n    this.data[this.length++] = value;\n\n    if (this.length > this.data.length) {\n      this.data.length *= 2;\n    }\n  };\n  /**\n   * Iterates over the active data and apply the lambda to them.\n   * @param func defines the action to apply on each value.\n   */\n\n\n  SmartArray.prototype.forEach = function (func) {\n    for (var index = 0; index < this.length; index++) {\n      func(this.data[index]);\n    }\n  };\n  /**\n   * Sorts the full sets of data.\n   * @param compareFn defines the comparison function to apply.\n   */\n\n\n  SmartArray.prototype.sort = function (compareFn) {\n    this.data.sort(compareFn);\n  };\n  /**\n   * Resets the active data to an empty array.\n   */\n\n\n  SmartArray.prototype.reset = function () {\n    this.length = 0;\n  };\n  /**\n   * Releases all the data from the array as well as the array.\n   */\n\n\n  SmartArray.prototype.dispose = function () {\n    this.reset();\n\n    if (this.data) {\n      this.data.length = 0;\n      this.data = [];\n    }\n  };\n  /**\n   * Concats the active data with a given array.\n   * @param array defines the data to concatenate with.\n   */\n\n\n  SmartArray.prototype.concat = function (array) {\n    if (array.length === 0) {\n      return;\n    }\n\n    if (this.length + array.length > this.data.length) {\n      this.data.length = (this.length + array.length) * 2;\n    }\n\n    for (var index = 0; index < array.length; index++) {\n      this.data[this.length++] = (array.data || array)[index];\n    }\n  };\n  /**\n   * Returns the position of a value in the active data.\n   * @param value defines the value to find the index for\n   * @returns the index if found in the active data otherwise -1\n   */\n\n\n  SmartArray.prototype.indexOf = function (value) {\n    var position = this.data.indexOf(value);\n\n    if (position >= this.length) {\n      return -1;\n    }\n\n    return position;\n  };\n  /**\n   * Returns whether an element is part of the active data.\n   * @param value defines the value to look for\n   * @returns true if found in the active data otherwise false\n   */\n\n\n  SmartArray.prototype.contains = function (value) {\n    return this.indexOf(value) !== -1;\n  }; // Statics\n\n\n  SmartArray._GlobalId = 0;\n  return SmartArray;\n}();\n\nexport { SmartArray };\n/**\n * Defines an GC Friendly array where the backfield array do not shrink to prevent over allocations.\n * The data in this array can only be present once\n */\n\nvar SmartArrayNoDuplicate =\n/** @class */\nfunction (_super) {\n  __extends(SmartArrayNoDuplicate, _super);\n\n  function SmartArrayNoDuplicate() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this._duplicateId = 0;\n    return _this;\n  }\n  /**\n   * Pushes a value at the end of the active data.\n   * THIS DOES NOT PREVENT DUPPLICATE DATA\n   * @param value defines the object to push in the array.\n   */\n\n\n  SmartArrayNoDuplicate.prototype.push = function (value) {\n    _super.prototype.push.call(this, value);\n\n    if (!value.__smartArrayFlags) {\n      value.__smartArrayFlags = {};\n    }\n\n    value.__smartArrayFlags[this._id] = this._duplicateId;\n  };\n  /**\n   * Pushes a value at the end of the active data.\n   * If the data is already present, it won t be added again\n   * @param value defines the object to push in the array.\n   * @returns true if added false if it was already present\n   */\n\n\n  SmartArrayNoDuplicate.prototype.pushNoDuplicate = function (value) {\n    if (value.__smartArrayFlags && value.__smartArrayFlags[this._id] === this._duplicateId) {\n      return false;\n    }\n\n    this.push(value);\n    return true;\n  };\n  /**\n   * Resets the active data to an empty array.\n   */\n\n\n  SmartArrayNoDuplicate.prototype.reset = function () {\n    _super.prototype.reset.call(this);\n\n    this._duplicateId++;\n  };\n  /**\n   * Concats the active data with a given array.\n   * This ensures no duplicate will be present in the result.\n   * @param array defines the data to concatenate with.\n   */\n\n\n  SmartArrayNoDuplicate.prototype.concatWithNoDuplicate = function (array) {\n    if (array.length === 0) {\n      return;\n    }\n\n    if (this.length + array.length > this.data.length) {\n      this.data.length = (this.length + array.length) * 2;\n    }\n\n    for (var index = 0; index < array.length; index++) {\n      var item = (array.data || array)[index];\n      this.pushNoDuplicate(item);\n    }\n  };\n\n  return SmartArrayNoDuplicate;\n}(SmartArray);\n\nexport { SmartArrayNoDuplicate };","map":{"version":3,"mappings":"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","names":["capacity","data","Array","_id","SmartArray","_GlobalId","value","length","func","index","compareFn","sort","reset","array","position","indexOf","__extends","_this","SmartArrayNoDuplicate","_super","push","call","__smartArrayFlags","_duplicateId","item","pushNoDuplicate"],"sourceRoot":"","sources":["../../../../../lts/core/generated/Misc/smartArray.ts"],"sourcesContent":["/**\r\n * Defines an array and its length.\r\n * It can be helpful to group result from both Arrays and smart arrays in one structure.\r\n */\r\nexport interface ISmartArrayLike<T> {\r\n    /**\r\n     * The data of the array.\r\n     */\r\n    data: Array<T>;\r\n    /**\r\n     * The active length of the array.\r\n     */\r\n    length: number;\r\n}\r\n\r\n/**\r\n * Defines an GC Friendly array where the backfield array do not shrink to prevent over allocations.\r\n */\r\nexport class SmartArray<T> implements ISmartArrayLike<T> {\r\n    /**\r\n     * The full set of data from the array.\r\n     */\r\n    public data: Array<T>;\r\n\r\n    /**\r\n     * The active length of the array.\r\n     */\r\n    public length: number = 0;\r\n\r\n    protected _id: number;\r\n\r\n    /**\r\n     * Instantiates a Smart Array.\r\n     * @param capacity defines the default capacity of the array.\r\n     */\r\n    constructor(capacity: number) {\r\n        this.data = new Array(capacity);\r\n        this._id = SmartArray._GlobalId++;\r\n    }\r\n\r\n    /**\r\n     * Pushes a value at the end of the active data.\r\n     * @param value defines the object to push in the array.\r\n     */\r\n    public push(value: T): void {\r\n        this.data[this.length++] = value;\r\n\r\n        if (this.length > this.data.length) {\r\n            this.data.length *= 2;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Iterates over the active data and apply the lambda to them.\r\n     * @param func defines the action to apply on each value.\r\n     */\r\n    public forEach(func: (content: T) => void): void {\r\n        for (let index = 0; index < this.length; index++) {\r\n            func(this.data[index]);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Sorts the full sets of data.\r\n     * @param compareFn defines the comparison function to apply.\r\n     */\r\n    public sort(compareFn: (a: T, b: T) => number): void {\r\n        this.data.sort(compareFn);\r\n    }\r\n\r\n    /**\r\n     * Resets the active data to an empty array.\r\n     */\r\n    public reset(): void {\r\n        this.length = 0;\r\n    }\r\n\r\n    /**\r\n     * Releases all the data from the array as well as the array.\r\n     */\r\n    public dispose(): void {\r\n        this.reset();\r\n\r\n        if (this.data) {\r\n            this.data.length = 0;\r\n            this.data = [];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Concats the active data with a given array.\r\n     * @param array defines the data to concatenate with.\r\n     */\r\n    public concat(array: any): void {\r\n        if (array.length === 0) {\r\n            return;\r\n        }\r\n        if (this.length + array.length > this.data.length) {\r\n            this.data.length = (this.length + array.length) * 2;\r\n        }\r\n\r\n        for (let index = 0; index < array.length; index++) {\r\n            this.data[this.length++] = (array.data || array)[index];\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Returns the position of a value in the active data.\r\n     * @param value defines the value to find the index for\r\n     * @returns the index if found in the active data otherwise -1\r\n     */\r\n    public indexOf(value: T): number {\r\n        const position = this.data.indexOf(value);\r\n\r\n        if (position >= this.length) {\r\n            return -1;\r\n        }\r\n\r\n        return position;\r\n    }\r\n\r\n    /**\r\n     * Returns whether an element is part of the active data.\r\n     * @param value defines the value to look for\r\n     * @returns true if found in the active data otherwise false\r\n     */\r\n    public contains(value: T): boolean {\r\n        return this.indexOf(value) !== -1;\r\n    }\r\n\r\n    // Statics\r\n    private static _GlobalId = 0;\r\n}\r\n\r\n/**\r\n * Defines an GC Friendly array where the backfield array do not shrink to prevent over allocations.\r\n * The data in this array can only be present once\r\n */\r\nexport class SmartArrayNoDuplicate<T> extends SmartArray<T> {\r\n    private _duplicateId = 0;\r\n\r\n    /**\r\n     * Pushes a value at the end of the active data.\r\n     * THIS DOES NOT PREVENT DUPPLICATE DATA\r\n     * @param value defines the object to push in the array.\r\n     */\r\n    public push(value: T): void {\r\n        super.push(value);\r\n\r\n        if (!(<any>value).__smartArrayFlags) {\r\n            (<any>value).__smartArrayFlags = {};\r\n        }\r\n\r\n        (<any>value).__smartArrayFlags[this._id] = this._duplicateId;\r\n    }\r\n\r\n    /**\r\n     * Pushes a value at the end of the active data.\r\n     * If the data is already present, it won t be added again\r\n     * @param value defines the object to push in the array.\r\n     * @returns true if added false if it was already present\r\n     */\r\n    public pushNoDuplicate(value: T): boolean {\r\n        if ((<any>value).__smartArrayFlags && (<any>value).__smartArrayFlags[this._id] === this._duplicateId) {\r\n            return false;\r\n        }\r\n        this.push(value);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Resets the active data to an empty array.\r\n     */\r\n    public reset(): void {\r\n        super.reset();\r\n        this._duplicateId++;\r\n    }\r\n\r\n    /**\r\n     * Concats the active data with a given array.\r\n     * This ensures no duplicate will be present in the result.\r\n     * @param array defines the data to concatenate with.\r\n     */\r\n    public concatWithNoDuplicate(array: any): void {\r\n        if (array.length === 0) {\r\n            return;\r\n        }\r\n        if (this.length + array.length > this.data.length) {\r\n            this.data.length = (this.length + array.length) * 2;\r\n        }\r\n\r\n        for (let index = 0; index < array.length; index++) {\r\n            const item = (array.data || array)[index];\r\n            this.pushNoDuplicate(item);\r\n        }\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}